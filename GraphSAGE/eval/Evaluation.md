# Link Stealing Attack - Evaluation

> Transductive and Inductive Link Stealing Attacks on GraphSAGE GNNs

## Target model - GraphSAGE GNN

#### Approach
Given a graph with a few labeled nodes the model performs label prediction on the unlabeled ones. For calculation of the feature / embedding vectors, GraphSAGE is used. GraphSage calculates the embedding of node `i` based on their neighborhood (connected nodes).

#### Parameter
| Parameter     | Value     
|------         |------     
| Type          | GraphSAGE
| Epochs        | 200
| Hidden Layer  | 2         
| Hidden Nodes  | 16         
| Learning Rate | 0.01      
| Dropout       | 0.5
| Optimizer     | Adam


## Attacker model - Multi-Layer Perceptron

#### Approach
Given a Graph Neural Network the model performs a link stealing attack based on the posteriors that are generated by the GNN.

#### Parameter
| Parameter     | Value     
|------         |------     
| Type          | MLP
| Epochs        | 200
| Hidden Layer  | 2         
| Hidden Nodes  | 16        
| Learning Rate | 0.01       
| Dropout       | 0.5
| Optimizer     | Adam


## Attack

### Setup
- Dataset `d`
- Target model `target` is trained on **subgraph** of `d`
- Attacker model `attacker` queries `target` on node-pairs
- predicts based on posteriors whether they are connected or not

### Knowledge of Attacker
- Target Dataset `d` that was used for training `target`
- Query Access to Target model `target`

### Dataset Generation
- Split Dataset `d` into `traingraph` and `testgraph`

##### Target Model
- Train Target Model `target` on `traingraph`
- No validating or testing

##### Attacker Model
- Remove random edges from `testgraph`
  - `modified_testgraph`
- Query `target` on `modified_testgraph` to obtain attacker dataset `da`
  - positive samples - edges that have been removed from `testgraph`
  - negative samples - edges that didn't exist in `testgraph`
- Train Attacker model `attacker` on `da`

<img src="img/Inductive.png" alt="drawing" width="800"/>

### Training the Attacker Model
One feature vector, consisting of two posteriors, is the input for the model. It then predicts whether the two nodes, of which the posteriors came from, are connected or not. The label is used for calculating the loss and updating the network.

### Results
Average Accuracy of `20` runs

| (Parent) Dataset  | Target | Attacker     
|------             |------  |-------
| Cora              | 0.7520 | 0.7855
| Citeseer          | 0.7088 | 0.7959
| Pubmed            | 0.8566 | 0.6602
